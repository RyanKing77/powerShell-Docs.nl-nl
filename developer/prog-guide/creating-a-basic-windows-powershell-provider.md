---
title: Het maken van een eenvoudige Windows PowerShell-Provider | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- base provider [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], base provider
ms.assetid: 11eeea41-15c8-47ad-9016-0f4b72573305
caps.latest.revision: 7
ms.openlocfilehash: 5ebc22067b20f0e1d35d31d5f33e599f50cb7564
ms.sourcegitcommit: 01b81317029b28dd9b61d167045fd31f1ec7bc06
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 05/17/2019
ms.locfileid: "65855068"
---
# <a name="creating-a-basic-windows-powershell-provider"></a><span data-ttu-id="ae36a-102">Een eenvoudige Windows PowerShell-provider ontwerpen</span><span class="sxs-lookup"><span data-stu-id="ae36a-102">Creating a Basic Windows PowerShell Provider</span></span>

<span data-ttu-id="ae36a-103">In dit onderwerp is het beginpunt voor het leren over het maken van een Windows PowerShell-provider.</span><span class="sxs-lookup"><span data-stu-id="ae36a-103">This topic is the starting point for learning how to create a Windows PowerShell provider.</span></span> <span data-ttu-id="ae36a-104">De basic-provider die hier worden beschreven biedt methoden voor het starten en stoppen van de provider en hoewel deze provider geen een manier toegang tot een gegevensarchief biedt of als u wilt ophalen of instellen van de gegevens in het gegevensarchief, biedt de essentiële functionaliteit die is vereist voor alle providers.</span><span class="sxs-lookup"><span data-stu-id="ae36a-104">The basic provider described here provides methods for starting and stopping the provider, and although this provider does not provide a means to access a data store or to get or set the data in the data store, it does provide the basic functionality that is required by all providers.</span></span>

<span data-ttu-id="ae36a-105">Zoals eerder vermeld, de basic-provider beschreven hier implementeert methoden voor het starten en stoppen van de provider.</span><span class="sxs-lookup"><span data-stu-id="ae36a-105">As mentioned previously, the basic provider described here implements methods for starting and stopping the provider.</span></span> <span data-ttu-id="ae36a-106">De Windows PowerShell-runtime roept deze methoden voor het initialiseren en initialisatie van de provider.</span><span class="sxs-lookup"><span data-stu-id="ae36a-106">The Windows PowerShell runtime calls these methods to initialize and uninitialize the provider.</span></span>

> [!NOTE]
> <span data-ttu-id="ae36a-107">U vindt een voorbeeld van deze provider in het bestand AccessDBSampleProvider01.cs is geleverd door Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="ae36a-107">You can find a sample of this provider in the AccessDBSampleProvider01.cs file provided by Windows PowerShell.</span></span>

## <a name="defining-the-windows-powershell-provider-class"></a><span data-ttu-id="ae36a-108">De Windows PowerShell-Provider-klasse definiëren</span><span class="sxs-lookup"><span data-stu-id="ae36a-108">Defining the Windows PowerShell Provider Class</span></span>

<span data-ttu-id="ae36a-109">De eerste stap bij het maken van een Windows PowerShell-provider is voor het definiëren van de .NET-klasse.</span><span class="sxs-lookup"><span data-stu-id="ae36a-109">The first step in creating a Windows PowerShell provider is to define its .NET class.</span></span> <span data-ttu-id="ae36a-110">Deze eenvoudige provider definieert een klasse genaamd `AccessDBProvider` die is afgeleid van de [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) basisklasse.</span><span class="sxs-lookup"><span data-stu-id="ae36a-110">This basic provider defines a class called `AccessDBProvider` that derives from the [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class.</span></span>

<span data-ttu-id="ae36a-111">Het wordt aanbevolen dat u plaatst u de klassen van de provider in een `Providers` naamruimte van de naamruimte van uw API, bijvoorbeeld: xxx. PowerShell.Providers.</span><span class="sxs-lookup"><span data-stu-id="ae36a-111">It is recommended that you place your provider classes in a `Providers` namespace of your API namespace, for example, xxx.PowerShell.Providers.</span></span> <span data-ttu-id="ae36a-112">Maakt gebruik van deze provider de `Microsoft.Samples.PowerShell.Provider` naamruimte, waarin alle voorbeelden van Windows PowerShell-provider wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="ae36a-112">This provider uses the `Microsoft.Samples.PowerShell.Provider` namespace, in which all Windows PowerShell provider samples run.</span></span>

> [!NOTE]
> <span data-ttu-id="ae36a-113">De klasse voor een Windows PowerShell-provider moet expliciet gemarkeerd als openbaar.</span><span class="sxs-lookup"><span data-stu-id="ae36a-113">The class for a Windows PowerShell provider must be explicitly marked as public.</span></span> <span data-ttu-id="ae36a-114">Klassen die niet zijn gemarkeerd als openbare standaard ingesteld op interne en zal niet worden gevonden door de Windows PowerShell-runtime.</span><span class="sxs-lookup"><span data-stu-id="ae36a-114">Classes not marked as public will default to internal and will not be found by the Windows PowerShell runtime.</span></span>

<span data-ttu-id="ae36a-115">Hier volgt de definitie van de klasse voor deze provider basic:</span><span class="sxs-lookup"><span data-stu-id="ae36a-115">Here is the class definition for this basic provider:</span></span>

[!code-csharp[AccessDBProviderSample01.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample01/AccessDBProviderSample01.cs#L23-L24 "AccessDBProviderSample01.cs")]

<span data-ttu-id="ae36a-116">Vlak voor de klassendefinitie van de die u moet declareren het [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) kenmerk met de syntaxis van de [CmdletProvider()].</span><span class="sxs-lookup"><span data-stu-id="ae36a-116">Right before the class definition, you must declare the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute, with the syntax [CmdletProvider()].</span></span>

<span data-ttu-id="ae36a-117">U kunt instellen dat kenmerk trefwoorden voor de klasse verder declareren indien nodig.</span><span class="sxs-lookup"><span data-stu-id="ae36a-117">You can set attribute keywords to further declare the class if necessary.</span></span> <span data-ttu-id="ae36a-118">U ziet dat de [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) kenmerk hier gedeclareerd bevat twee parameters.</span><span class="sxs-lookup"><span data-stu-id="ae36a-118">Notice that the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute declared here includes two parameters.</span></span> <span data-ttu-id="ae36a-119">De eerste parameter van kenmerk Hiermee geeft u de standaard-beschrijvende naam voor de provider, die de gebruiker later kunt wijzigen.</span><span class="sxs-lookup"><span data-stu-id="ae36a-119">The first attribute parameter specifies the default-friendly name for the provider, which the user can modify later.</span></span> <span data-ttu-id="ae36a-120">De tweede parameter geeft u de mogelijkheden van Windows PowerShell-gedefinieerd die de provider wordt aangegeven in de Windows PowerShell-runtime tijdens de verwerking van de opdracht.</span><span class="sxs-lookup"><span data-stu-id="ae36a-120">The second parameter specifies the Windows PowerShell-defined capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="ae36a-121">De mogelijke waarden voor de provider-mogelijkheden zijn gedefinieerd door de [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) opsomming.</span><span class="sxs-lookup"><span data-stu-id="ae36a-121">The possible values for the provider capabilities are defined by the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="ae36a-122">Omdat dit een basis-provider, ondersteunt geen mogelijkheden.</span><span class="sxs-lookup"><span data-stu-id="ae36a-122">Because this is a base provider, it supports no capabilities.</span></span>

> [!NOTE]
> <span data-ttu-id="ae36a-123">De volledig gekwalificeerde naam van de Windows PowerShell-provider bevat de assembly-naam en andere kenmerken bepaald door de Windows PowerShell bij de registratie van de provider.</span><span class="sxs-lookup"><span data-stu-id="ae36a-123">The fully qualified name of the Windows PowerShell provider includes the assembly name and other attributes determined by Windows PowerShell upon registration of the provider.</span></span>

## <a name="defining-provider-specific-state-information"></a><span data-ttu-id="ae36a-124">Informatie over de status van de Provider-specifieke definiëren</span><span class="sxs-lookup"><span data-stu-id="ae36a-124">Defining Provider-Specific State Information</span></span>

<span data-ttu-id="ae36a-125">De [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) basisklasse en alle afgeleide klassen worden beschouwd als stateless omdat de Windows PowerShell-runtime provider instanties zoals vereist maakt.</span><span class="sxs-lookup"><span data-stu-id="ae36a-125">The [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class and all derived classes are considered stateless because the Windows PowerShell runtime creates provider instances only as required.</span></span> <span data-ttu-id="ae36a-126">Als uw provider volledig beheer en onderhoud van de status voor de provider-specifieke gegevens moet, moet deze daarom een klasse vanuit afleiden de [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) klasse.</span><span class="sxs-lookup"><span data-stu-id="ae36a-126">Therefore, if your provider requires full control and state maintenance for provider-specific data, it must derive a class from the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) class.</span></span> <span data-ttu-id="ae36a-127">De afgeleide klasse de leden die nodig zijn voor het onderhouden van de status, zodat de provider-specifieke gegevens kunnen worden geopend wanneer de Windows PowerShell-runtime-aanroepen moet definiëren de [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) methode om te initialiseren van de provider.</span><span class="sxs-lookup"><span data-stu-id="ae36a-127">Your derived class should define the members necessary to maintain the state so that the provider-specific data can be accessed when the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to initialize the provider.</span></span>

<span data-ttu-id="ae36a-128">Een Windows PowerShell-provider kan de status op basis van een verbinding ook onderhouden.</span><span class="sxs-lookup"><span data-stu-id="ae36a-128">A Windows PowerShell provider can also maintain connection-based state.</span></span> <span data-ttu-id="ae36a-129">Zie voor meer informatie over het onderhouden van de verbindingsstatus [het maken van een PowerShell-Provider station](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="ae36a-129">For more information about maintaining connection state, see [Creating a PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

## <a name="initializing-the-provider"></a><span data-ttu-id="ae36a-130">Tijdens de initialisatie van de Provider</span><span class="sxs-lookup"><span data-stu-id="ae36a-130">Initializing the Provider</span></span>

<span data-ttu-id="ae36a-131">Initialiseren van de provider van het aanroepen van de Windows PowerShell-runtime de [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) methode wanneer Windows PowerShell wordt gestart.</span><span class="sxs-lookup"><span data-stu-id="ae36a-131">To initialize the provider, the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method when Windows PowerShell is started.</span></span> <span data-ttu-id="ae36a-132">Uw provider kunt voor het overgrote deel de standaardimplementatie van deze methode retourneert de [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) -object dat uw provider beschrijft.</span><span class="sxs-lookup"><span data-stu-id="ae36a-132">For the most part, your provider can use the default implementation of this method, which simply returns the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that describes your provider.</span></span> <span data-ttu-id="ae36a-133">Echter, in het geval waar u informatie over de extra initialisatie toevoegen, moet u implementeren uw eigen [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) methode een gewijzigde versie van de retourneert[ System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) -object dat wordt doorgegeven aan uw provider.</span><span class="sxs-lookup"><span data-stu-id="ae36a-133">However, in the case where you want to add additional initialization information, you should implement your own [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method that returns a modified version of the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that is passed to your provider.</span></span> <span data-ttu-id="ae36a-134">In het algemeen deze methode moet retourneren de opgegeven [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object doorgegeven aan deze of een gewijzigde [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object dat bevat informatie over de andere initialisatie.</span><span class="sxs-lookup"><span data-stu-id="ae36a-134">In general, this method should return the provided [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object passed to it or a modified [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that contains other initialization information.</span></span>

<span data-ttu-id="ae36a-135">Deze methode wordt niet door deze eenvoudige provider worden overschreven.</span><span class="sxs-lookup"><span data-stu-id="ae36a-135">This basic provider does not override this method.</span></span> <span data-ttu-id="ae36a-136">De volgende code toont echter de standaardimplementatie van deze methode:</span><span class="sxs-lookup"><span data-stu-id="ae36a-136">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStart](Msh_samplesaccessdbprov01#accessdbprov01ProviderStart)]  -->

<span data-ttu-id="ae36a-137">De provider van de status van de provider-specifieke informatie kunt bijhouden, zoals beschreven in [definiëren Provider-specifieke gegevens status](#defining-provider-specific-state-information).</span><span class="sxs-lookup"><span data-stu-id="ae36a-137">The provider can maintain the state of provider-specific information as described in [Defining Provider-specific Data State](#defining-provider-specific-state-information).</span></span> <span data-ttu-id="ae36a-138">In dit geval uw implementatie moet overschrijven de [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) methode om te retourneren van een exemplaar van de afgeleide klasse.</span><span class="sxs-lookup"><span data-stu-id="ae36a-138">In this case, your implementation must override the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to return an instance of the derived class.</span></span>

## <a name="start-dynamic-parameters"></a><span data-ttu-id="ae36a-139">Dynamische Parameters starten</span><span class="sxs-lookup"><span data-stu-id="ae36a-139">Start Dynamic Parameters</span></span>

<span data-ttu-id="ae36a-140">De providerimplementatie van de [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) methode mogelijk extra parameters.</span><span class="sxs-lookup"><span data-stu-id="ae36a-140">Your provider implementation of the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method might require additional parameters.</span></span> <span data-ttu-id="ae36a-141">In dit geval de provider moet worden overschreven de [System.Management.Automation.Provider.Cmdletprovider.Startdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) methode en retourneren een object met eigenschappen en velden met het parseren van die vergelijkbaar is met kenmerken een cmdlet-klasse of een [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span><span class="sxs-lookup"><span data-stu-id="ae36a-141">In this case, the provider should override the [System.Management.Automation.Provider.Cmdletprovider.Startdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) method and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="ae36a-142">Deze methode wordt niet door deze eenvoudige provider worden overschreven.</span><span class="sxs-lookup"><span data-stu-id="ae36a-142">This basic provider does not override this method.</span></span> <span data-ttu-id="ae36a-143">De volgende code toont echter de standaardimplementatie van deze methode:</span><span class="sxs-lookup"><span data-stu-id="ae36a-143">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters](Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters)]  -->

## <a name="uninitializing-the-provider"></a><span data-ttu-id="ae36a-144">De Provider uninitializing</span><span class="sxs-lookup"><span data-stu-id="ae36a-144">Uninitializing the Provider</span></span>

<span data-ttu-id="ae36a-145">Voor gratis resources die gebruikmaakt van de Windows PowerShell-provider, de provider moet implementeren een eigen [System.Management.Automation.Provider.Cmdletprovider.Stop\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) methode.</span><span class="sxs-lookup"><span data-stu-id="ae36a-145">To free resources that the Windows PowerShell provider uses, your provider should implement its own [System.Management.Automation.Provider.Cmdletprovider.Stop\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) method.</span></span> <span data-ttu-id="ae36a-146">Deze methode wordt aangeroepen door de Windows PowerShell-runtime initialisatie van de provider op de sluiting van een sessie.</span><span class="sxs-lookup"><span data-stu-id="ae36a-146">This method is called by the Windows PowerShell runtime to uninitialize the provider at the close of a session.</span></span>

<span data-ttu-id="ae36a-147">Deze methode wordt niet door deze eenvoudige provider worden overschreven.</span><span class="sxs-lookup"><span data-stu-id="ae36a-147">This basic provider does not override this method.</span></span> <span data-ttu-id="ae36a-148">De volgende code toont echter de standaardimplementatie van deze methode:</span><span class="sxs-lookup"><span data-stu-id="ae36a-148">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStop](Msh_samplesaccessdbprov01#accessdbprov01ProviderStop)]  -->

## <a name="code-sample"></a><span data-ttu-id="ae36a-149">Voorbeeld van code</span><span class="sxs-lookup"><span data-stu-id="ae36a-149">Code Sample</span></span>

<span data-ttu-id="ae36a-150">Zie voor een compleet voorbeeld van code, [AccessDbProviderSample01 codevoorbeeld](./accessdbprovidersample01-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="ae36a-150">For complete sample code, see [AccessDbProviderSample01 Code Sample](./accessdbprovidersample01-code-sample.md).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="ae36a-151">De Windows PowerShell-Provider testen</span><span class="sxs-lookup"><span data-stu-id="ae36a-151">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="ae36a-152">Zodra uw Windows PowerShell-provider is geregistreerd met Windows PowerShell, kunt u deze testen door het uitvoeren van de ondersteunde cmdlets op de opdrachtregel.</span><span class="sxs-lookup"><span data-stu-id="ae36a-152">Once your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="ae36a-153">Voor deze provider basic, uitvoeren van de nieuwe shell en gebruik de `Get-PSProvider` cmdlet voor het ophalen van de lijst met providers en zorg ervoor dat de provider AccessDb aanwezig is.</span><span class="sxs-lookup"><span data-stu-id="ae36a-153">For this basic provider, run the new shell and use the `Get-PSProvider` cmdlet to retrieve the list of providers and ensure that the AccessDb provider is present.</span></span>

```powershell
Get-PSProvider
```

<span data-ttu-id="ae36a-154">De volgende uitvoer wordt weergegeven:</span><span class="sxs-lookup"><span data-stu-id="ae36a-154">The following output appears:</span></span>

```output
Name                 Capabilities                  Drives
----                 ------------                  ------
AccessDb             None                          {}
Alias                ShouldProcess                 {Alias}
Environment          ShouldProcess                 {Env}
FileSystem           Filter, ShouldProcess         {C, Z}
Function             ShouldProcess                 {function}
Registry             ShouldProcess                 {HKLM, HKCU}
```

## <a name="see-also"></a><span data-ttu-id="ae36a-155">Zie ook</span><span class="sxs-lookup"><span data-stu-id="ae36a-155">See Also</span></span>

[<span data-ttu-id="ae36a-156">Het maken van Windows PowerShell-Providers</span><span class="sxs-lookup"><span data-stu-id="ae36a-156">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="ae36a-157">Het ontwerpen van uw Windows PowerShell-Provider</span><span class="sxs-lookup"><span data-stu-id="ae36a-157">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)