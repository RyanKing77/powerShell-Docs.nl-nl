---
ms.date: 06/05/2017
keywords: PowerShell-cmdlet
title: De Windows PowerShell 2.0-engine starten
ms.assetid: edafc2fa-7576-49c2-bbba-9336f4bcfc28
ms.openlocfilehash: f5dd01cd93095fe15cc7e57f97f4b2920e580c22
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 02/03/2019
ms.locfileid: "55688929"
---
# <a name="starting-the-windows-powershell-20-engine"></a><span data-ttu-id="8b5b0-103">De Windows PowerShell 2.0-engine starten</span><span class="sxs-lookup"><span data-stu-id="8b5b0-103">Starting the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="8b5b0-104">In deze sectie wordt uitgelegd hoe u de Windows PowerShell 2.0-Engine op Windows 8.1, Windows Server 2012 R2, Windows 8 en Windows Server 2012, waaronder de Windows PowerShell 2.0-Engine, en op andere systemen op welke Windows PowerShell 2.0, Windows PowerShell starten 3.0 en Windows PowerShell 4.0 zijn geïnstalleerd.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-104">This section explains how to start the Windows PowerShell 2.0 Engine on Windows 8.1, Windows Server 2012 R2, Windows 8, and Windows Server 2012, which include the Windows PowerShell 2.0 Engine, and on other systems on which Windows PowerShell 2.0, Windows PowerShell 3.0, and Windows PowerShell 4.0 are installed.</span></span>

<span data-ttu-id="8b5b0-105">Windows PowerShell 4.0 en Windows PowerShell 3.0 zijn ontworpen voor achterwaartse compatibiliteit met Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-105">Windows PowerShell 4.0 and Windows PowerShell 3.0 are designed to be backwards compatible with Windows PowerShell 2.0.</span></span> <span data-ttu-id="8b5b0-106">-Cmdlets, providers, -modules, modules en scripts die zijn geschreven voor Windows PowerShell 2.0 uitvoeren in Windows PowerShell 4.0 en Windows PowerShell 3.0 ongewijzigd.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-106">Cmdlets, providers, snap-ins, modules, and scripts written for Windows PowerShell 2.0 run unchanged in Windows PowerShell 4.0 and Windows PowerShell 3.0.</span></span> <span data-ttu-id="8b5b0-107">Echter, vanwege een wijziging in het beleid van de runtime-activering in Microsoft .NET Framework 4, Windows PowerShell-host-programma's die zijn geschreven voor Windows PowerShell 2.0 en gecompileerd met Common Language Runtime (CLR) 2.0 kunnen niet worden uitgevoerd zonder aanpassingen in Windows PowerShell 3.0 of Windows PowerShell 4.0, die met CLR-4.0 worden gecompileerd.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-107">However, due to a change in the runtime activation policy in Microsoft .NET Framework 4, Windows PowerShell host programs that were written for Windows PowerShell 2.0 and compiled with Common Language Runtime (CLR) 2.0 cannot run without modification in Windows PowerShell 3.0 or Windows PowerShell 4.0, which are compiled with CLR 4.0.</span></span> <span data-ttu-id="8b5b0-108">De Windows PowerShell 2.0-Engine moet worden gebruikt alleen wanneer een bestaand script is bedoeld of hostprogramma kan niet worden uitgevoerd omdat deze niet compatibel met Windows PowerShell 4.0, Windows PowerShell 3.0 of Microsoft .NET Framework 4 is.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-108">The Windows PowerShell 2.0 Engine is intended to be used only when an existing script or host program cannot run because it is incompatible with Windows PowerShell 4.0, Windows PowerShell 3.0, or Microsoft .NET Framework 4.</span></span> <span data-ttu-id="8b5b0-109">Dergelijke gevallen wordt wordt een zeldzaam verwacht.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-109">Such cases are expected to be rare.</span></span>

<span data-ttu-id="8b5b0-110">Veel programma's waarvoor de Windows PowerShell 2.0-Engine wordt automatisch gestart.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-110">Many programs that require the Windows PowerShell 2.0 Engine start it automatically.</span></span> <span data-ttu-id="8b5b0-111">Deze instructies zijn opgenomen voor de zeldzame gevallen waarin u moet de engine om handmatig te starten.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-111">These instructions are included for the rare situations in which you need to start the engine manually.</span></span>

## <a name="installing-and-enabling-required-programs"></a><span data-ttu-id="8b5b0-112">Installeren en inschakelen van vereiste programma 's</span><span class="sxs-lookup"><span data-stu-id="8b5b0-112">Installing and Enabling Required Programs</span></span>

<span data-ttu-id="8b5b0-113">Voordat u begint met de Windows PowerShell 2.0-Engine, moet u de Windows PowerShell 2.0-Engine en Microsoft .NET Framework 3.5 met Service Pack 1 inschakelen.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-113">Before starting the Windows PowerShell 2.0 Engine, enable the Windows PowerShell 2.0 Engine and Microsoft .NET Framework 3.5 with Service Pack 1.</span></span> <span data-ttu-id="8b5b0-114">Zie voor instructies [Windows PowerShell installeren](../install/Installing-Windows-PowerShell.md).</span><span class="sxs-lookup"><span data-stu-id="8b5b0-114">For instructions, see [Installing Windows PowerShell](../install/Installing-Windows-PowerShell.md).</span></span>

<span data-ttu-id="8b5b0-115">Systemen hebben alle vereiste onderdelen op welke Windows Management Framework 4.0 of Windows Management Framework 3.0 zijn geïnstalleerd.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-115">Systems on which Windows Management Framework 4.0 or Windows Management Framework 3.0 are installed have all of the required components.</span></span> <span data-ttu-id="8b5b0-116">Er is geen verdere configuratie nodig.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-116">No further configuration is necessary.</span></span> <span data-ttu-id="8b5b0-117">Voor informatie over het installeren van [Windows Management Framework 4.0](https://go.microsoft.com/fwlink/?LinkID=293881) of Windows Management Framework 3.0, Zie [Windows PowerShell installeren](../install/Installing-Windows-PowerShell.md).</span><span class="sxs-lookup"><span data-stu-id="8b5b0-117">For information about installing [Windows Management Framework 4.0](https://go.microsoft.com/fwlink/?LinkID=293881) or Windows Management Framework 3.0, see [Installing Windows PowerShell](../install/Installing-Windows-PowerShell.md).</span></span>

## <a name="how-to-start-the-windows-powershell-20-engine"></a><span data-ttu-id="8b5b0-118">De Windows PowerShell 2.0-Engine starten</span><span class="sxs-lookup"><span data-stu-id="8b5b0-118">How to start the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="8b5b0-119">Wanneer u Windows PowerShell Start wordt standaard de nieuwste versie gestart.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-119">When you start Windows PowerShell the newest version starts by default.</span></span> <span data-ttu-id="8b5b0-120">Voor het starten van Windows PowerShell met de Windows PowerShell 2.0-Engine, moet u de versie-parameter van PowerShell.exe gebruiken.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-120">To start Windows PowerShell with the Windows PowerShell 2.0 Engine, use the Version parameter of PowerShell.exe.</span></span> <span data-ttu-id="8b5b0-121">U kunt de opdracht uitvoeren bij een opdrachtprompt, met inbegrip van Windows PowerShell en Cmd.exe.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-121">You can run the command at any command prompt, including Windows PowerShell and Cmd.exe.</span></span>

```
PowerShell.exe -Version 2
```

## <a name="how-to-start-a-remote-session-with-the-windows-powershell-20-engine"></a><span data-ttu-id="8b5b0-122">Een externe sessie starten met de Windows PowerShell 2.0-Engine</span><span class="sxs-lookup"><span data-stu-id="8b5b0-122">How to start a remote session with the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="8b5b0-123">Voor het uitvoeren van de Windows PowerShell 2.0-Engine in een externe sessie, maakt u een sessieconfiguratie (ook wel bekend als een ' eindpunt') op de externe computer waarop de Windows PowerShell 2.0-Engine wordt geladen.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-123">To run the Windows PowerShell 2.0 Engine in a remote session, create a session configuration (also known as an "endpoint") on the remote computer that loads the Windows PowerShell 2.0 Engine.</span></span> <span data-ttu-id="8b5b0-124">De sessieconfiguratie van de wordt opgeslagen op de externe computer en kan worden gebruikt door een geautoriseerde gebruiker maken sessies die gebruikmaken van de Windows PowerShell 2.0-Engine.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-124">The session configuration is saved on the remote computer and can be used by any authorized user to create sessions that use the Windows PowerShell 2.0 Engine.</span></span>

<span data-ttu-id="8b5b0-125">Dit is een geavanceerde taak die wordt doorgaans uitgevoerd door een systeembeheerder.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-125">This is an advanced task that is typically performed by a system administrator.</span></span>

<span data-ttu-id="8b5b0-126">De volgende procedure maakt gebruik van de **PSVersion** parameter van de [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet voor het maken van een sessieconfiguratie die gebruikmaakt van de Windows PowerShell 2.0-Engine.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-126">The following procedure uses the **PSVersion** parameter of the [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet to create a session configuration that uses the Windows PowerShell 2.0 Engine.</span></span> <span data-ttu-id="8b5b0-127">U kunt ook de **PowerShellVersion** parameter van de [New-PSSessionConfigurationFile](https://technet.microsoft.com/library/5f3e3633-6e90-479c-aea9-ba45a1954866) cmdlet voor het maken van een sessie-configuratiebestand voor een sessie die de Windows PowerShell 2.0-Engine wordt geladen en u kunt de **PSVersion** parameter van de [Set-PSSessionConfiguration](https://technet.microsoft.com/library/b21fbad3-1759-4260-b206-dcb8431cd6ea) parameter voor het wijzigen van de sessieconfiguratie van een voor het gebruik van de Windows PowerShell 2.0-Engine.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-127">You can also use the **PowerShellVersion** parameter of the [New-PSSessionConfigurationFile](https://technet.microsoft.com/library/5f3e3633-6e90-479c-aea9-ba45a1954866) cmdlet to create a session configuration file for a session that loads the Windows PowerShell 2.0 Engine and you can use the **PSVersion** parameter of the [Set-PSSessionConfiguration](https://technet.microsoft.com/library/b21fbad3-1759-4260-b206-dcb8431cd6ea) parameter to change a session configuration to use the Windows PowerShell 2.0 Engine.</span></span>

<span data-ttu-id="8b5b0-128">Zie voor meer informatie over de sessie-configuratiebestanden, [about_Session_Configuration_Files](https://technet.microsoft.com/library/c7217447-1ebf-477b-a8ef-4dbe9a1473b8). Zie voor meer informatie over sessieconfiguraties, met inbegrip van setup en beveiliging, [about_Session_Configurations [v4]](https://technet.microsoft.com/library/a2fbe12a-350c-4d04-be50-24102824e3ab).</span><span class="sxs-lookup"><span data-stu-id="8b5b0-128">For more information about session configuration files, see [about_Session_Configuration_Files](https://technet.microsoft.com/library/c7217447-1ebf-477b-a8ef-4dbe9a1473b8).For information about session configurations, including setup and security, see [about_Session_Configurations[v4]](https://technet.microsoft.com/library/a2fbe12a-350c-4d04-be50-24102824e3ab).</span></span>

#### <a name="to-start-a-remote-windows-powershell-20-session"></a><span data-ttu-id="8b5b0-129">Een externe Windows PowerShell 2.0-sessie te starten</span><span class="sxs-lookup"><span data-stu-id="8b5b0-129">To start a remote Windows PowerShell 2.0 session</span></span>

1. <span data-ttu-id="8b5b0-130">Voor het maken van een sessieconfiguratie waarvoor de Windows PowerShell 2.0-Engine gebruikt de **PSVersion** parameter van de [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet met de waarde '2.0'.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-130">To create a session configuration that requires the Windows PowerShell 2.0 Engine, use the **PSVersion** parameter of the [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet with a value of "2.0".</span></span> <span data-ttu-id="8b5b0-131">Deze opdracht uitvoeren op de computer op het 'server-side' of de ontvangende kant van de verbinding.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-131">Run this command on the computer at the "server side" or receiving end of the connection.</span></span>

   <span data-ttu-id="8b5b0-132">De volgende voorbeeldopdracht wordt de configuratie van de PS2-sessie op de computer Server01 gemaakt.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-132">The following sample command creates the PS2 session configuration on the Server01 computer.</span></span> <span data-ttu-id="8b5b0-133">Als u wilt deze opdracht uitvoert, start u Windows PowerShell 4.0 of Windows PowerShell 3.0 met de **als administrator uitvoeren** optie.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-133">To run this command, start Windows PowerShell 4.0 or Windows PowerShell 3.0 with the **Run as administrator** option.</span></span>

   ```powershell
   Register-PSSessionConfiguration -Name PS2 -PSVersion 2.0
   ```

2. <span data-ttu-id="8b5b0-134">Gebruik voor het maken van een sessie op de computer Server01 die gebruikmaakt van de sessieconfiguratie PS2 de **ConfigurationName** parameter van cmdlets die het maken van een externe sessie, zoals de [New-PSSession](https://technet.microsoft.com/library/76f6628c-054c-4eda-ba7a-a6f28daaa26f) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-134">To create a session on the Server01 computer that uses the PS2 session configuration, use the **ConfigurationName** parameter of cmdlets that create a remote session, such as the [New-PSSession](https://technet.microsoft.com/library/76f6628c-054c-4eda-ba7a-a6f28daaa26f) cmdlet.</span></span>

   <span data-ttu-id="8b5b0-135">Wanneer een sessie die gebruikmaakt van de sessieconfiguratie van de wordt gestart, wordt de Windows PowerShell 2.0-Engine wordt automatisch geladen in de sessie.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-135">When a session that uses the session configuration starts, the Windows PowerShell 2.0 Engine is automatically loaded into the session.</span></span>

   <span data-ttu-id="8b5b0-136">De volgende opdracht start een sessie op de computer Server01 die gebruikmaakt van de configuratie van de PS2-sessie.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-136">The following command starts a session on the Server01 computer that uses the PS2 session configuration.</span></span> <span data-ttu-id="8b5b0-137">De opdracht wordt de sessie opgeslagen in de variabele $s.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-137">The command saves the session in the $s variable.</span></span>

   ```powershell
   $s = New-PSSession -ComputerName Server01 -ConfigurationName PS2
   ```

## <a name="how-to-start-a-background-job-with-the-windows-powershell-20-engine"></a><span data-ttu-id="8b5b0-138">Een achtergrondtaak te starten met de Windows PowerShell 2.0-Engine</span><span class="sxs-lookup"><span data-stu-id="8b5b0-138">How to start a background job with the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="8b5b0-139">Gebruiken om een achtergrondtaak starten met de Windows PowerShell 2.0-Engine, het **PSVersion** parameter van de [Start-Job](https://technet.microsoft.com/library/2bc04935-0deb-4ec0-b856-d7290cca6442) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="8b5b0-139">To start a background job with the Windows PowerShell 2.0 Engine, use the **PSVersion** parameter of the [Start-Job](https://technet.microsoft.com/library/2bc04935-0deb-4ec0-b856-d7290cca6442) cmdlet.</span></span>

<span data-ttu-id="8b5b0-140">De volgende opdracht start een achtergrondtaak met de Windows PowerShell 2.0-Engine</span><span class="sxs-lookup"><span data-stu-id="8b5b0-140">The following command starts a background job with the Windows PowerShell 2.0 Engine</span></span>

```powershell
Start-Job {Get-Process} -PSVersion 2.0
```

<span data-ttu-id="8b5b0-141">Zie voor meer informatie over achtergrondtaken [about_Jobs](/powershell/module/microsoft.powershell.core/about/about_jobs).</span><span class="sxs-lookup"><span data-stu-id="8b5b0-141">For more information about background jobs, see [about_Jobs](/powershell/module/microsoft.powershell.core/about/about_jobs).</span></span>