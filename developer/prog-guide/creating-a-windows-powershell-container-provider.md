---
title: Het maken van een Windows PowerShell-Provider Container | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- providers [PowerShell Programmer's Guide], container provider
- container providers [PowerShell Programmer's Guide]
ms.assetid: a7926647-0d18-45b2-967e-b31f92004bc4
caps.latest.revision: 5
ms.openlocfilehash: 33effed9a96cf1b9ee5f1a50b60a1937526db9d1
ms.sourcegitcommit: caac7d098a448232304c9d6728e7340ec7517a71
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 03/16/2019
ms.locfileid: "58055016"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="0d519-102">Een Windows PowerShell-containerprovider maken</span><span class="sxs-lookup"><span data-stu-id="0d519-102">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="0d519-103">In dit onderwerp wordt beschreven hoe u een Windows PowerShell-provider die kan worden gebruikt voor gegevensopslag met meerdere lagen maken.</span><span class="sxs-lookup"><span data-stu-id="0d519-103">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="0d519-104">Het hoogste niveau van de store bevat de items van de hoofdmap voor dit type gegevensarchief, en elke latere niveau wordt aangeduid als een knooppunt van het onderliggende items.</span><span class="sxs-lookup"><span data-stu-id="0d519-104">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="0d519-105">Een gebruiker kan door de gebruiker om te werken op deze onderliggende knooppunten, hiërarchisch communiceren via het gegevensarchief.</span><span class="sxs-lookup"><span data-stu-id="0d519-105">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="0d519-106">Providers die kunnen worden gebruikt voor meerdere niveaus gegevensarchieven worden aangeduid als Windows PowerShell-container-providers.</span><span class="sxs-lookup"><span data-stu-id="0d519-106">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="0d519-107">Wel rekening mee dat de provider van een Windows PowerShell-container kan worden gebruikt alleen wanneer er een container (geen geneste containers) met items erin.</span><span class="sxs-lookup"><span data-stu-id="0d519-107">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="0d519-108">Als er geneste containers, moet u een Windows PowerShell-provider voor navigatie implementeren.</span><span class="sxs-lookup"><span data-stu-id="0d519-108">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="0d519-109">Zie voor meer informatie over het implementeren van Windows PowerShell-navigatie-provider [het maken van een Windows PowerShell-Provider navigatie](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0d519-109">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="0d519-110">U kunt downloaden de C# bronbestand (AccessDBSampleProvider04.cs) voor deze provider met behulp van de Microsoft Windows Software Development Kit voor Windows Vista en .NET Framework 3.0 Runtime-onderdelen.</span><span class="sxs-lookup"><span data-stu-id="0d519-110">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="0d519-111">Zie voor instructies voor het downloaden [hoe u Windows PowerShell installeren en Download de Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="0d519-111">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="0d519-112">De bronbestanden van de gedownloade zijn beschikbaar in de  **\<voorbeelden van PowerShell >** directory.</span><span class="sxs-lookup"><span data-stu-id="0d519-112">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="0d519-113">Zie voor meer informatie over andere Windows PowerShell-provider-implementaties, [het ontwerpen van uw Windows PowerShell-Provider](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0d519-113">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="0d519-114">De Windows PowerShell-container-provider die hier worden beschreven definieert de database als de één container, met de tabellen en rijen van de database die is gedefinieerd als items van de container.</span><span class="sxs-lookup"><span data-stu-id="0d519-114">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="0d519-115">Let erop dat dit ontwerp wordt ervan uitgegaan dat een database waarvoor een veld met de naam-ID en dat het type van het veld LongInteger is.</span><span class="sxs-lookup"><span data-stu-id="0d519-115">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

<span data-ttu-id="0d519-116">Hier volgt een lijst van de secties in dit onderwerp.</span><span class="sxs-lookup"><span data-stu-id="0d519-116">Here is a list of the sections in this topic.</span></span> <span data-ttu-id="0d519-117">Als u niet bekend bent met het schrijven van een Windows PowerShell-container-provider, leest u deze informatie in de volgorde waarin deze wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-117">If you are unfamiliar with writing a Windows PowerShell container provider, please read this information in the order that it appears.</span></span> <span data-ttu-id="0d519-118">Echter, als u bekend bent met het schrijven van een Windows PowerShell-container-provider, gaat u rechtstreeks naar de informatie die u nodig hebt.</span><span class="sxs-lookup"><span data-stu-id="0d519-118">However, if you are familiar with writing a Windows PowerShell container provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="0d519-119">Een Windows PowerShell-Container providerklasse definiëren</span><span class="sxs-lookup"><span data-stu-id="0d519-119">Defining a Windows PowerShell Container Provider Class</span></span>](#Defining-a-Windows-PowerShell-Container-Provider-Class)

- [<span data-ttu-id="0d519-120">Basisfunctionaliteit definiëren</span><span class="sxs-lookup"><span data-stu-id="0d519-120">Defining Base Functionality</span></span>](#defining-base-functionality)

- [<span data-ttu-id="0d519-121">Bij het ophalen van onderliggende Items</span><span class="sxs-lookup"><span data-stu-id="0d519-121">Retrieving Child Items</span></span>](#Retrieving-Child-Items)

- [<span data-ttu-id="0d519-122">Bezig met koppelen van dynamische Parameters voor de `Get-ChildItem` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0d519-122">Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet)

- [<span data-ttu-id="0d519-123">Bij het ophalen van namen van de onderliggende items</span><span class="sxs-lookup"><span data-stu-id="0d519-123">Retrieving Child Item Names</span></span>](#Retrieving-Child-Item-Names)

- <span data-ttu-id="0d519-124">[Bezig met koppelen van dynamische Parameters voor de `Get-ChildItem` Cmdlet (naam)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span><span class="sxs-lookup"><span data-stu-id="0d519-124">[Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet (Name)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span></span>

- [<span data-ttu-id="0d519-125">Naam van Items wijzigen</span><span class="sxs-lookup"><span data-stu-id="0d519-125">Renaming Items</span></span>](#Renaming-Items)

- [<span data-ttu-id="0d519-126">Bezig met koppelen van dynamische Parameters voor de `Rename-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0d519-126">Attaching Dynamic Parameters to the  `Rename-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Rename-Item-Cmdlet)

- [<span data-ttu-id="0d519-127">Het maken van nieuwe Items</span><span class="sxs-lookup"><span data-stu-id="0d519-127">Creating New Items</span></span>](#Creating-New-Items)

- [<span data-ttu-id="0d519-128">Bezig met koppelen van dynamische Parameters voor de `New-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0d519-128">Attaching Dynamic Parameters to the `New-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-New-Item-Cmdlet)

- [<span data-ttu-id="0d519-129">Een Items verwijderen</span><span class="sxs-lookup"><span data-stu-id="0d519-129">Removing a Items</span></span>](#Removing-Items)

- [<span data-ttu-id="0d519-130">Bezig met koppelen van dynamische Parameters voor de `Remove-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0d519-130">Attaching Dynamic Parameters to the `Remove-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Remove-Item-Cmdlet)

- [<span data-ttu-id="0d519-131">Query's uitvoeren voor de onderliggende Items</span><span class="sxs-lookup"><span data-stu-id="0d519-131">Querying for Child Items</span></span>](#Querying-for-Child-Items)

- [<span data-ttu-id="0d519-132">Kopieert Items</span><span class="sxs-lookup"><span data-stu-id="0d519-132">Coping Items</span></span>](#Copying-Items)

- [<span data-ttu-id="0d519-133">Bezig met koppelen van dynamische Parameters voor de `Copy-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0d519-133">Attaching Dynamic Parameters to the  `Copy-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Copy-Item-Cmdlet)

- [<span data-ttu-id="0d519-134">Voorbeeld van code</span><span class="sxs-lookup"><span data-stu-id="0d519-134">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="0d519-135">Het bouwen van de Windows PowerShell-Provider</span><span class="sxs-lookup"><span data-stu-id="0d519-135">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-Provider)

- [<span data-ttu-id="0d519-136">De Windows PowerShell-Provider testen</span><span class="sxs-lookup"><span data-stu-id="0d519-136">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-Provider)

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="0d519-137">Een Windows PowerShell-Container providerklasse definiëren</span><span class="sxs-lookup"><span data-stu-id="0d519-137">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="0d519-138">Een Windows PowerShell-container-provider moet definiëren van een .NET-klasse die is afgeleid van de [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) basisklasse.</span><span class="sxs-lookup"><span data-stu-id="0d519-138">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="0d519-139">Hier volgt de definitie van de klasse voor de Windows PowerShell-container-provider in deze sectie beschreven.</span><span class="sxs-lookup"><span data-stu-id="0d519-139">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
   [CmdletProvider("AccessDB", ProviderCapabilities.None)]
   public class AccessDBProvider : ContainerCmdletProvider
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L34-L35 "AccessDBProviderSample04.cs")]

<span data-ttu-id="0d519-140">U ziet dat in deze klassedefinitie, de [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) kenmerk bevat twee parameters.</span><span class="sxs-lookup"><span data-stu-id="0d519-140">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="0d519-141">De eerste parameter geeft u een gebruiksvriendelijke naam voor de provider die wordt gebruikt door Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0d519-141">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="0d519-142">De tweede parameter geeft u de Windows PowerShell-specifieke mogelijkheden die de provider wordt aangegeven in de Windows PowerShell-runtime tijdens de verwerking van de opdracht.</span><span class="sxs-lookup"><span data-stu-id="0d519-142">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="0d519-143">Er zijn geen specifieke mogelijkheden van Windows PowerShell die worden toegevoegd voor deze provider.</span><span class="sxs-lookup"><span data-stu-id="0d519-143">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="0d519-144">Basisfunctionaliteit definiëren</span><span class="sxs-lookup"><span data-stu-id="0d519-144">Defining Base Functionality</span></span>

<span data-ttu-id="0d519-145">Zoals beschreven in [het ontwerpen van uw Windows PowerShell-Provider](./designing-your-windows-powershell-provider.md), wordt de [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) klasse is afgeleid van diverse andere klassen die opgegeven functionaliteit van de andere provider.</span><span class="sxs-lookup"><span data-stu-id="0d519-145">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="0d519-146">Daarom moet de provider van een Windows PowerShell-container, de functionaliteit van deze klassen te definiëren.</span><span class="sxs-lookup"><span data-stu-id="0d519-146">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="0d519-147">Zie voor het implementeren van de functionaliteit voor het toevoegen van informatie over de initialisatie van de sessie-specifieke en voor het vrijgeven van resources die worden gebruikt door de provider [het maken van een eenvoudige Windows PowerShell-Provider](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0d519-147">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="0d519-148">De meeste providers (met inbegrip van de provider die hier worden beschreven) kunnen echter de standaardimplementatie van deze functionaliteit die wordt geleverd door Windows PowerShell gebruiken.</span><span class="sxs-lookup"><span data-stu-id="0d519-148">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="0d519-149">Voor toegang tot het gegevensarchief, moet de provider de methoden voor het implementeren van de [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) basisklasse.</span><span class="sxs-lookup"><span data-stu-id="0d519-149">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="0d519-150">Zie voor meer informatie over het implementeren van deze methoden [het maken van een Windows PowerShell station Provider](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0d519-150">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="0d519-151">Als u wilt bewerken van de items van een gegevensarchief, zoals ophalen, instellen en items wissen, de provider van de methoden die door moet implementeren de [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) basisklasse.</span><span class="sxs-lookup"><span data-stu-id="0d519-151">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="0d519-152">Zie voor meer informatie over het implementeren van deze methoden [het maken van een Windows PowerShell-Provider Item](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0d519-152">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="0d519-153">Bij het ophalen van onderliggende Items</span><span class="sxs-lookup"><span data-stu-id="0d519-153">Retrieving Child Items</span></span>

<span data-ttu-id="0d519-154">Als u wilt ophalen van een onderliggend item, de Windows PowerShell-container-provider moet overschrijven de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) methode voor de ondersteuning van aanroepen vanuit de `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0d519-154">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="0d519-155">Deze methode worden onderliggende items opgehaald uit het gegevensarchief en schrijft deze naar de pijplijn als objecten.</span><span class="sxs-lookup"><span data-stu-id="0d519-155">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="0d519-156">Als de `recurse` parameter van de cmdlet is opgegeven, wordt de methode haalt alle items ongeacht welk niveau deze zijn.</span><span class="sxs-lookup"><span data-stu-id="0d519-156">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="0d519-157">Als de `recurse` parameter niet wordt opgegeven, de methode wordt slechts één niveau van onderliggende items opgehaald.</span><span class="sxs-lookup"><span data-stu-id="0d519-157">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="0d519-158">Hier volgt de implementatie van de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) methode voor deze provider.</span><span class="sxs-lookup"><span data-stu-id="0d519-158">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="0d519-159">U ziet dat door deze methode de onderliggende items in alle databasetabellen moet worden opgehaald wanneer het pad geeft aan de Access-database dat en de onderliggende items opgehaald uit de rijen van de tabel als het pad aangeeft een tabel met gegevens dat.</span><span class="sxs-lookup"><span data-stu-id="0d519-159">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L311-L362 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="0d519-160">Om te onthouden over het implementeren van GetChildItems</span><span class="sxs-lookup"><span data-stu-id="0d519-160">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="0d519-161">De volgende voorwaarden mogelijk van toepassing op de implementatie van [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="0d519-161">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="0d519-162">Bij het definiëren van de providerklasse, een Windows PowerShell-container-provider provider mogelijkheden van ExpandWildcards, Filter, opnemen of uitsluiten, mogelijk declareren van de [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) opsomming.</span><span class="sxs-lookup"><span data-stu-id="0d519-162">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="0d519-163">In dergelijke gevallen de uitvoering van de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) methode vereist om ervoor te zorgen dat het pad dat is doorgegeven aan de methode voldoet aan de vereisten van de opgegeven mogelijkheden.</span><span class="sxs-lookup"><span data-stu-id="0d519-163">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="0d519-164">U doet dit door de methode moet toegang tot de juiste eigenschap, bijvoorbeeld, de [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) en [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) eigenschappen.</span><span class="sxs-lookup"><span data-stu-id="0d519-164">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="0d519-165">De uitvoering van deze methode moet rekening houden een vorm van toegang aan het item dat het item zichtbaar voor de gebruiker mogelijk maken.</span><span class="sxs-lookup"><span data-stu-id="0d519-165">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="0d519-166">Bijvoorbeeld, als een gebruiker toegang voor schrijven naar een bestand via de bestandssysteem-provider heeft (geleverd door Windows PowerShell), maar niet de toegang lezen, het bestand nog bestaat en [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) retourneert `true`.</span><span class="sxs-lookup"><span data-stu-id="0d519-166">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="0d519-167">Uw implementatie mogelijk de controle van een bovenliggend item om te zien als het kind kan worden geïnventariseerd.</span><span class="sxs-lookup"><span data-stu-id="0d519-167">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="0d519-168">Bij het schrijven van meerdere items, de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) methode kan enige tijd duren.</span><span class="sxs-lookup"><span data-stu-id="0d519-168">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="0d519-169">U kunt uw provider om te schrijven van de artikelen met ontwerpen de [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) methode op een tijdstip.</span><span class="sxs-lookup"><span data-stu-id="0d519-169">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="0d519-170">Met deze techniek om de items in een stroom aan de gebruiker te presenteren.</span><span class="sxs-lookup"><span data-stu-id="0d519-170">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="0d519-171">De implementatie van [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is verantwoordelijk voor het voorkomen van oneindige recursie wanneer er circulaire koppelingen en dergelijke zijn.</span><span class="sxs-lookup"><span data-stu-id="0d519-171">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="0d519-172">Een juiste afsluitende uitzondering moet worden gegenereerd om een voorwaarde weer te geven.</span><span class="sxs-lookup"><span data-stu-id="0d519-172">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="0d519-173">Dynamische Parameters toevoegen aan de Cmdlet Get-ChildItem</span><span class="sxs-lookup"><span data-stu-id="0d519-173">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="0d519-174">Soms de `Get-ChildItem` cmdlet die worden aangeroepen [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) vereist extra parameters die dynamisch zijn opgegeven tijdens runtime.</span><span class="sxs-lookup"><span data-stu-id="0d519-174">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="0d519-175">Voor deze dynamische parameters, de Windows PowerShell-container-provider moet implementeren de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-175">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="0d519-176">Deze methode haalt dynamische parameters voor het item in het opgegeven pad op en retourneert een object met eigenschappen en velden met het parseren van kenmerken die vergelijkbaar is met een cmdlet-klasse of een [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span><span class="sxs-lookup"><span data-stu-id="0d519-176">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="0d519-177">De Windows PowerShell-runtime maakt gebruik van het geretourneerde object om toe te voegen van de parameters voor de `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0d519-177">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="0d519-178">Deze Windows PowerShell-container-provider wordt niet geïmplementeerd voor deze methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-178">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="0d519-179">De volgende code is echter de standaardimplementatie van deze methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-179">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="0d519-180">Bij het ophalen van namen van de onderliggende items</span><span class="sxs-lookup"><span data-stu-id="0d519-180">Retrieving Child Item Names</span></span>

<span data-ttu-id="0d519-181">Als u wilt ophalen van de namen van de onderliggende items, de Windows PowerShell-container-provider moet overschrijven de [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) methode voor de ondersteuning van aanroepen vanuit de `Get-ChildItem`cmdlet wanneer de `Name` parameter is opgegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-181">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="0d519-182">Deze methode worden de namen van de onderliggende items voor het opgegeven pad of een onderliggend itemnamen voor alle containers opgehaald als de `returnAllContainers` parameter van de cmdlet is opgegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-182">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="0d519-183">De naam van een onderliggende is het leaf-gedeelte van een pad.</span><span class="sxs-lookup"><span data-stu-id="0d519-183">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="0d519-184">Bijvoorbeeld, is de naam van de onderliggende voor het pad c:\windows\system32\abc.dll 'abc.dll'.</span><span class="sxs-lookup"><span data-stu-id="0d519-184">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="0d519-185">De naam van de onderliggende voor de map c:\windows\system32 is 'system32'.</span><span class="sxs-lookup"><span data-stu-id="0d519-185">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="0d519-186">Hier volgt de implementatie van de [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) methode voor deze provider.</span><span class="sxs-lookup"><span data-stu-id="0d519-186">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="0d519-187">U ziet dat de methode tabelnamen opgehaald als het opgegeven pad geeft aan dat de Access-database (station) en rijnummers als het pad aangeeft een tabel dat.</span><span class="sxs-lookup"><span data-stu-id="0d519-187">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L369-L411 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="0d519-188">Om te onthouden over het implementeren van GetChildNames</span><span class="sxs-lookup"><span data-stu-id="0d519-188">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="0d519-189">De volgende voorwaarden mogelijk van toepassing op de implementatie van [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="0d519-189">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="0d519-190">Bij het definiëren van de providerklasse, een Windows PowerShell-container-provider provider mogelijkheden van ExpandWildcards, Filter, opnemen of uitsluiten, mogelijk declareren van de [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) opsomming.</span><span class="sxs-lookup"><span data-stu-id="0d519-190">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="0d519-191">In dergelijke gevallen de uitvoering van de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) methode vereist om ervoor te zorgen dat het pad dat is doorgegeven aan de methode voldoet aan de vereisten van de opgegeven mogelijkheden.</span><span class="sxs-lookup"><span data-stu-id="0d519-191">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="0d519-192">U doet dit door de methode moet toegang tot de juiste eigenschap, bijvoorbeeld, de [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) en [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) eigenschappen.</span><span class="sxs-lookup"><span data-stu-id="0d519-192">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="0d519-193">Een uitzondering op deze regel treedt op wanneer de `returnAllContainers` parameter van de cmdlet is opgegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-193">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="0d519-194">In dit geval wordt de methode een willekeurige naam onderliggende voor een container moet ophalen, zelfs als deze komt niet overeen met de waarden van de [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), of [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) eigenschappen.</span><span class="sxs-lookup"><span data-stu-id="0d519-194">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="0d519-195">Standaard onderdrukkingen van deze methode niet Haal de namen van objecten die in het algemeen van de gebruiker worden verborgen, tenzij de [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) eigenschap is opgegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-195">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="0d519-196">Als het opgegeven pad geeft aan een container dat, de [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) eigenschap is niet vereist.</span><span class="sxs-lookup"><span data-stu-id="0d519-196">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="0d519-197">De implementatie van [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is verantwoordelijk voor het voorkomen van oneindige recursie wanneer er circulaire koppelingen en dergelijke zijn.</span><span class="sxs-lookup"><span data-stu-id="0d519-197">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="0d519-198">Een juiste afsluitende uitzondering moet worden gegenereerd om een voorwaarde weer te geven.</span><span class="sxs-lookup"><span data-stu-id="0d519-198">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="0d519-199">Dynamische Parameters toevoegen aan de Cmdlet Get-ChildItem (naam)</span><span class="sxs-lookup"><span data-stu-id="0d519-199">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="0d519-200">Soms de `Get-ChildItem` cmdlet (met de `Name` parameter) is vereist extra parameters die dynamisch zijn opgegeven tijdens runtime.</span><span class="sxs-lookup"><span data-stu-id="0d519-200">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="0d519-201">Voor deze dynamische parameters, de Windows PowerShell-container-provider moet implementeren de [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-201">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="0d519-202">Deze methode haalt de dynamische parameters voor het item in het opgegeven pad en retourneert een object met eigenschappen en velden met het parseren van kenmerken die vergelijkbaar is met een cmdlet-klasse of een [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span><span class="sxs-lookup"><span data-stu-id="0d519-202">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="0d519-203">De Windows PowerShell-runtime maakt gebruik van het geretourneerde object om toe te voegen van de parameters voor de `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0d519-203">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="0d519-204">Deze provider wordt niet geïmplementeerd voor deze methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-204">This provider does not implement this method.</span></span> <span data-ttu-id="0d519-205">De volgende code is echter de standaardimplementatie van deze methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-205">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="0d519-206">Naam van Items wijzigen</span><span class="sxs-lookup"><span data-stu-id="0d519-206">Renaming Items</span></span>

<span data-ttu-id="0d519-207">Wijzig de naam van een item, een Windows PowerShell-container-provider moet overschrijven de [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) methode voor de ondersteuning van aanroepen vanuit de `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0d519-207">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="0d519-208">Deze methode wordt de naam van het item in het opgegeven pad naar de nieuwe naam opgegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-208">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="0d519-209">De nieuwe naam moet altijd ten opzichte van het bovenliggende item (container).</span><span class="sxs-lookup"><span data-stu-id="0d519-209">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="0d519-210">Deze provider wordt niet overschreven de [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-210">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="0d519-211">Het volgende is echter de standaardimplementatie.</span><span class="sxs-lookup"><span data-stu-id="0d519-211">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="0d519-212">Om te onthouden over het implementeren van RenameItem</span><span class="sxs-lookup"><span data-stu-id="0d519-212">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="0d519-213">De volgende voorwaarden mogelijk van toepassing op de implementatie van [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span><span class="sxs-lookup"><span data-stu-id="0d519-213">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="0d519-214">Bij het definiëren van de providerklasse, een Windows PowerShell-container-provider provider mogelijkheden van ExpandWildcards, Filter, opnemen of uitsluiten, mogelijk declareren van de [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) opsomming.</span><span class="sxs-lookup"><span data-stu-id="0d519-214">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="0d519-215">In dergelijke gevallen de uitvoering van de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) methode vereist om ervoor te zorgen dat het pad dat is doorgegeven aan de methode voldoet aan de vereisten van de opgegeven mogelijkheden.</span><span class="sxs-lookup"><span data-stu-id="0d519-215">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="0d519-216">U doet dit door de methode moet toegang tot de juiste eigenschap, bijvoorbeeld, de [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) en [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) eigenschappen.</span><span class="sxs-lookup"><span data-stu-id="0d519-216">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="0d519-217">De [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) methode is bedoeld voor het aanpassen van de naam van een item alleen en niet voor verplaatsingsbewerkingen.</span><span class="sxs-lookup"><span data-stu-id="0d519-217">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span> <span data-ttu-id="0d519-218">De implementatie van de methode een fout moet schrijven als de `newName` parameter padscheidingstekens bevat, of kan ertoe leiden dat het item te wijzigen van de bovenliggende locatie.</span><span class="sxs-lookup"><span data-stu-id="0d519-218">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="0d519-219">Standaard onderdrukkingen van deze methode mag niet de naam van objecten, tenzij de [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) eigenschap is opgegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-219">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="0d519-220">Als het opgegeven pad geeft aan een container dat, de [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) eigenschap is niet vereist.</span><span class="sxs-lookup"><span data-stu-id="0d519-220">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="0d519-221">De implementatie van de [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) methode moet aanroepen [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) en controleer de geretourneerde waarde voordat u wijzigingen aanbrengt aan de gegevensopslag.</span><span class="sxs-lookup"><span data-stu-id="0d519-221">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="0d519-222">Deze methode wordt gebruikt om te bevestigen van de uitvoering van een bewerking wanneer een wijziging wordt aangebracht in de systeemstatus, bijvoorbeeld bestandsnamen.</span><span class="sxs-lookup"><span data-stu-id="0d519-222">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="0d519-223">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) verzendt de naam van de resource moet worden gewijzigd voor de gebruiker met de Windows PowerShell-runtime rekening houdend met instellingen vanaf de opdrachtregel of voorkeursvariabelen in bepalen wat moet worden weergegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-223">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="0d519-224">Na het aanroepen van [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourneert `true`, wordt de [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) methode moet aanroepen de [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-224">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="0d519-225">Deze methode verzendt een bericht verschijnt een bevestigingsbericht aan de gebruiker om toe te staan aanvullende feedback in te spreken als de bewerking moet worden voortgezet.</span><span class="sxs-lookup"><span data-stu-id="0d519-225">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="0d519-226">Een provider moet aanroepen [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) als een aanvullende controle voor wijzigingen die mogelijk schadelijke system.</span><span class="sxs-lookup"><span data-stu-id="0d519-226">A provider should call [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="0d519-227">Dynamische Parameters toevoegen aan de Cmdlet Rename-Item</span><span class="sxs-lookup"><span data-stu-id="0d519-227">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="0d519-228">Soms de `Rename-Item` cmdlet extra parameters die dynamisch zijn opgegeven tijdens runtime is vereist.</span><span class="sxs-lookup"><span data-stu-id="0d519-228">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="0d519-229">Voor deze dynamische parameters, Windows PowerShell-container-provider moet implementeren de [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-229">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="0d519-230">Deze methode haalt de parameters voor het item in het opgegeven pad en retourneert een object met eigenschappen en velden met het parseren van kenmerken die vergelijkbaar is met een cmdlet-klasse of een [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span><span class="sxs-lookup"><span data-stu-id="0d519-230">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="0d519-231">De Windows PowerShell-runtime maakt gebruik van het geretourneerde object om toe te voegen van de parameters voor de `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0d519-231">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="0d519-232">Deze container-provider wordt niet geïmplementeerd voor deze methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-232">This container provider does not implement this method.</span></span> <span data-ttu-id="0d519-233">De volgende code is echter de standaardimplementatie van deze methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-233">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="0d519-234">Het maken van nieuwe Items</span><span class="sxs-lookup"><span data-stu-id="0d519-234">Creating New Items</span></span>

<span data-ttu-id="0d519-235">Voor het maken van nieuwe items aanbieder van de container moet implementeren de [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) methode voor de ondersteuning van aanroepen vanuit de `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0d519-235">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="0d519-236">Deze methode maakt u een gegevensitem dat zich bevindt in het opgegeven pad.</span><span class="sxs-lookup"><span data-stu-id="0d519-236">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="0d519-237">De `type` parameter van de cmdlet het type provider gedefinieerd voor het nieuwe item bevat.</span><span class="sxs-lookup"><span data-stu-id="0d519-237">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="0d519-238">De bestandssysteem-provider gebruikt bijvoorbeeld een `type` parameter met de waarde 'file' of 'directory'.</span><span class="sxs-lookup"><span data-stu-id="0d519-238">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="0d519-239">De `newItemValue` parameter van de cmdlet geeft u een provider-specifieke waarde voor het nieuwe item.</span><span class="sxs-lookup"><span data-stu-id="0d519-239">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="0d519-240">Hier volgt de implementatie van de [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) methode voor deze provider.</span><span class="sxs-lookup"><span data-stu-id="0d519-240">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type,
                                 object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L939-L955 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="0d519-241">Om te onthouden over het implementeren van nieuw item</span><span class="sxs-lookup"><span data-stu-id="0d519-241">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="0d519-242">De volgende voorwaarden mogelijk van toepassing op de implementatie van [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="0d519-242">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="0d519-243">De [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) methode moet worden uitgevoerd door een niet-hoofdlettergevoelige vergelijking van de tekenreeks wordt de `type` parameter.</span><span class="sxs-lookup"><span data-stu-id="0d519-243">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span> <span data-ttu-id="0d519-244">Het moet ook toestaan voor minste niet-eenduidige overeenkomsten.</span><span class="sxs-lookup"><span data-stu-id="0d519-244">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="0d519-245">Voor de typen 'file' en 'directory', bijvoorbeeld alleen de eerste letter vereist om op te heffen.</span><span class="sxs-lookup"><span data-stu-id="0d519-245">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="0d519-246">Als de `type` parameter geeft aan dat een type dat de provider niet maken kan, de [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) methode moet een ArgumentException met een bericht schrijven de typen die aangeeft kunt de provider maken.</span><span class="sxs-lookup"><span data-stu-id="0d519-246">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="0d519-247">Voor de `newItemValue` parameter, de implementatie van de [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) methode om te accepteren van tekenreeksen ten minste wordt aanbevolen.</span><span class="sxs-lookup"><span data-stu-id="0d519-247">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="0d519-248">Deze ook toestemming moet geven het type object dat is opgehaald door de [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) methode voor hetzelfde pad.</span><span class="sxs-lookup"><span data-stu-id="0d519-248">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="0d519-249">De [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) methode kunt gebruiken de [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) methode voor het converteren van het type aan het gewenste type.</span><span class="sxs-lookup"><span data-stu-id="0d519-249">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="0d519-250">De implementatie van de [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) methode moet aanroepen [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) en controleer de geretourneerde waarde voordat u wijzigingen aanbrengt aan de gegevensopslag.</span><span class="sxs-lookup"><span data-stu-id="0d519-250">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="0d519-251">Na het aanroepen van [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourneert ' True ', de [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) methode moet aanroepen de [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) methode als een aanvullende controle voor wijzigingen die mogelijk schadelijke system.</span><span class="sxs-lookup"><span data-stu-id="0d519-251">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="0d519-252">Dynamische Parameters toevoegen aan de Cmdlet Nieuw Item</span><span class="sxs-lookup"><span data-stu-id="0d519-252">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="0d519-253">Soms de `New-Item` cmdlet extra parameters die dynamisch zijn opgegeven tijdens runtime is vereist.</span><span class="sxs-lookup"><span data-stu-id="0d519-253">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="0d519-254">Voor deze dynamische parameters, de provider van de container moet implementeren de [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-254">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="0d519-255">Deze methode haalt de parameters voor het item in het opgegeven pad en retourneert een object met eigenschappen en velden met het parseren van kenmerken die vergelijkbaar is met een cmdlet-klasse of een [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span><span class="sxs-lookup"><span data-stu-id="0d519-255">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="0d519-256">De Windows PowerShell-runtime maakt gebruik van het geretourneerde object om toe te voegen van de parameters voor de `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0d519-256">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="0d519-257">Deze provider wordt niet geïmplementeerd voor deze methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-257">This provider does not implement this method.</span></span> <span data-ttu-id="0d519-258">De volgende code is echter de standaardimplementatie van deze methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-258">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="0d519-259">Items verwijderen</span><span class="sxs-lookup"><span data-stu-id="0d519-259">Removing Items</span></span>

<span data-ttu-id="0d519-260">Als u wilt verwijderen, de Windows PowerShell-provider moet overschrijven de [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) methode voor de ondersteuning van aanroepen vanuit de `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0d519-260">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="0d519-261">Deze methode wordt een item verwijderd uit het gegevensarchief in het opgegeven pad.</span><span class="sxs-lookup"><span data-stu-id="0d519-261">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="0d519-262">Als de `recurse` parameter van de `Remove-Item` cmdlet is ingesteld op `true`, de methode verwijdert u alle onderliggende items, ongeacht hun niveau.</span><span class="sxs-lookup"><span data-stu-id="0d519-262">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="0d519-263">Als de parameter is ingesteld op `false`, de methode verwijdert u slechts één item in het opgegeven pad.</span><span class="sxs-lookup"><span data-stu-id="0d519-263">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="0d519-264">Deze provider biedt geen ondersteuning voor het item verwijderen.</span><span class="sxs-lookup"><span data-stu-id="0d519-264">This provider does not support item removal.</span></span> <span data-ttu-id="0d519-265">De volgende code is echter de standaardimplementatie van [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span><span class="sxs-lookup"><span data-stu-id="0d519-265">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="0d519-266">Om te onthouden over het implementeren van RemoveItem</span><span class="sxs-lookup"><span data-stu-id="0d519-266">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="0d519-267">De volgende voorwaarden mogelijk van toepassing op de implementatie van [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="0d519-267">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="0d519-268">Bij het definiëren van de providerklasse, een Windows PowerShell-container-provider provider mogelijkheden van ExpandWildcards, Filter, opnemen of uitsluiten, mogelijk declareren van de [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) opsomming.</span><span class="sxs-lookup"><span data-stu-id="0d519-268">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="0d519-269">In dergelijke gevallen de uitvoering van de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) methode vereist om ervoor te zorgen dat het pad dat is doorgegeven aan de methode voldoet aan de vereisten van de opgegeven mogelijkheden.</span><span class="sxs-lookup"><span data-stu-id="0d519-269">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="0d519-270">U doet dit door de methode moet toegang tot de juiste eigenschap, bijvoorbeeld, de [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) en [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) eigenschappen.</span><span class="sxs-lookup"><span data-stu-id="0d519-270">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="0d519-271">Standaard onderdrukkingen van deze methode moeten niet verwijderen, objecten, tenzij de [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) eigenschap is ingesteld op true.</span><span class="sxs-lookup"><span data-stu-id="0d519-271">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="0d519-272">Als het opgegeven pad geeft aan een container dat, de [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) eigenschap is niet vereist.</span><span class="sxs-lookup"><span data-stu-id="0d519-272">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="0d519-273">De implementatie van [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is verantwoordelijk voor het voorkomen van oneindige recursie wanneer er circulaire koppelingen en dergelijke zijn.</span><span class="sxs-lookup"><span data-stu-id="0d519-273">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="0d519-274">Een juiste afsluitende uitzondering moet worden gegenereerd om een voorwaarde weer te geven.</span><span class="sxs-lookup"><span data-stu-id="0d519-274">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="0d519-275">De implementatie van de [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) methode moet aanroepen [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) en controleer de geretourneerde waarde voordat u wijzigingen aanbrengt aan de gegevensopslag.</span><span class="sxs-lookup"><span data-stu-id="0d519-275">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="0d519-276">Na het aanroepen van [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourneert `true`, wordt de [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) methode moet aanroepen de [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) methode als een aanvullende controle voor wijzigingen die mogelijk schadelijke system.</span><span class="sxs-lookup"><span data-stu-id="0d519-276">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="0d519-277">Dynamische Parameters toevoegen aan de Cmdlet Remove-Item</span><span class="sxs-lookup"><span data-stu-id="0d519-277">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="0d519-278">Soms de `Remove-Item` cmdlet extra parameters die dynamisch zijn opgegeven tijdens runtime is vereist.</span><span class="sxs-lookup"><span data-stu-id="0d519-278">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="0d519-279">Voor deze dynamische parameters, de provider van de container moet implementeren de [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) methode voor het afhandelen van deze parameters.</span><span class="sxs-lookup"><span data-stu-id="0d519-279">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="0d519-280">Deze methode haalt de dynamische parameters voor het item in het opgegeven pad en retourneert een object met eigenschappen en velden met het parseren van kenmerken die vergelijkbaar is met een cmdlet-klasse of een [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span><span class="sxs-lookup"><span data-stu-id="0d519-280">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="0d519-281">De Windows PowerShell-runtime maakt gebruik van het geretourneerde object om toe te voegen van de parameters voor de `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0d519-281">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="0d519-282">Deze container-provider wordt niet geïmplementeerd voor deze methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-282">This container provider does not implement this method.</span></span> <span data-ttu-id="0d519-283">De volgende code is echter de standaardimplementatie van [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="0d519-283">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="0d519-284">Query's uitvoeren voor de onderliggende Items</span><span class="sxs-lookup"><span data-stu-id="0d519-284">Querying for Child Items</span></span>

<span data-ttu-id="0d519-285">Als u wilt controleren om te zien als onderliggende items aanwezig zijn in het opgegeven pad, de Windows PowerShell-container-provider moet overschrijven de [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-285">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="0d519-286">Deze methode retourneert `true` als het item onderliggende items heeft, en `false` anders.</span><span class="sxs-lookup"><span data-stu-id="0d519-286">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="0d519-287">Voor een null of leeg pad, de methode rekening gehouden met alle items in het gegevensarchief moeten kinderen en retourneert `true`.</span><span class="sxs-lookup"><span data-stu-id="0d519-287">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="0d519-288">Hier volgt de onderdrukking voor de [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-288">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="0d519-289">Als er meer dan twee onderdelen van het bestandspad die zijn gemaakt door de ChunkPath Help-methode te zijn, retourneert de methode `false`, aangezien alleen de databasecontainer van een en een container van de tabel zijn gedefinieerd.</span><span class="sxs-lookup"><span data-stu-id="0d519-289">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="0d519-290">Zie voor meer informatie over deze Help-methode de methode ChunkPath wordt besproken in [het maken van een Windows PowerShell-Provider Item](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0d519-290">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L1094-L1097 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="0d519-291">Om te onthouden over het implementeren van HasChildItems</span><span class="sxs-lookup"><span data-stu-id="0d519-291">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="0d519-292">De volgende voorwaarden mogelijk van toepassing op de implementatie van [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span><span class="sxs-lookup"><span data-stu-id="0d519-292">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="0d519-293">Als de container-provider wordt aangegeven dat een toegangspunt met interessante koppelpunten, de implementatie van de [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) methode moet retourneren `true`wanneer een null-waarde of een lege tekenreeks is doorgegeven voor het pad.</span><span class="sxs-lookup"><span data-stu-id="0d519-293">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="0d519-294">Items kopiëren</span><span class="sxs-lookup"><span data-stu-id="0d519-294">Copying Items</span></span>

<span data-ttu-id="0d519-295">Als u wilt kopiëren items, de provider van de container moet implementeren de [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) methode voor de ondersteuning van aanroepen vanuit de `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0d519-295">To copy items, the container provider must implement the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="0d519-296">Deze methode wordt een gegevensitem gekopieerd vanaf de locatie die door de `path` parameter van de cmdlet naar de locatie die is aangegeven door de `copyPath` parameter.</span><span class="sxs-lookup"><span data-stu-id="0d519-296">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="0d519-297">Als de `recurse` parameter is opgegeven, wordt de methode kopieert alle onderliggende containers.</span><span class="sxs-lookup"><span data-stu-id="0d519-297">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="0d519-298">Als de parameter niet opgegeven is, wordt de methode slechts één niveau van items kopieert.</span><span class="sxs-lookup"><span data-stu-id="0d519-298">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="0d519-299">Deze provider wordt niet geïmplementeerd voor deze methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-299">This provider does not implement this method.</span></span> <span data-ttu-id="0d519-300">De volgende code is echter de standaardimplementatie van [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span><span class="sxs-lookup"><span data-stu-id="0d519-300">However, the following code is the default implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="0d519-301">Om te onthouden over het implementeren van CopyItem</span><span class="sxs-lookup"><span data-stu-id="0d519-301">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="0d519-302">De volgende voorwaarden mogelijk van toepassing op de implementatie van [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span><span class="sxs-lookup"><span data-stu-id="0d519-302">The following conditions may apply to your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="0d519-303">Bij het definiëren van de providerklasse, een Windows PowerShell-container-provider provider mogelijkheden van ExpandWildcards, Filter, opnemen of uitsluiten, mogelijk declareren van de [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) opsomming.</span><span class="sxs-lookup"><span data-stu-id="0d519-303">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="0d519-304">In dergelijke gevallen de uitvoering van de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) methode vereist om ervoor te zorgen dat het pad dat is doorgegeven aan de methode voldoet aan de vereisten van de opgegeven mogelijkheden.</span><span class="sxs-lookup"><span data-stu-id="0d519-304">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="0d519-305">U doet dit door de methode moet toegang tot de juiste eigenschap, bijvoorbeeld, de [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) en [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) eigenschappen.</span><span class="sxs-lookup"><span data-stu-id="0d519-305">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="0d519-306">Standaard onderdrukkingen van deze methode mag niet worden gekopieerd objecten op bestaande objecten, tenzij de [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) eigenschap is ingesteld op `true`.</span><span class="sxs-lookup"><span data-stu-id="0d519-306">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="0d519-307">Bijvoorbeeld, de provider van het bestandssysteem worden niet gekopieerd c:\temp\abc.txt via een bestaand c:\abc.txt-bestand, tenzij de [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) eigenschap is ingesteld op `true`.</span><span class="sxs-lookup"><span data-stu-id="0d519-307">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="0d519-308">Als het pad opgegeven in de `copyPath` parameter bestaat en een container geeft aan dat de [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) eigenschap is niet vereist.</span><span class="sxs-lookup"><span data-stu-id="0d519-308">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="0d519-309">In dit geval [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) kopieert het item dat wordt aangegeven door de `path` parameter voor de container aangegeven door de `copyPath` parameter als een onderliggend element.</span><span class="sxs-lookup"><span data-stu-id="0d519-309">In this case, [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="0d519-310">De implementatie van [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is verantwoordelijk voor het voorkomen van oneindige recursie wanneer er circulaire koppelingen en dergelijke zijn.</span><span class="sxs-lookup"><span data-stu-id="0d519-310">Your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="0d519-311">Een juiste afsluitende uitzondering moet worden gegenereerd om een voorwaarde weer te geven.</span><span class="sxs-lookup"><span data-stu-id="0d519-311">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="0d519-312">De implementatie van de [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) methode moet aanroepen [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) en controleer de geretourneerde waarde voordat u wijzigingen aanbrengt aan de gegevensopslag.</span><span class="sxs-lookup"><span data-stu-id="0d519-312">Your implementation of the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="0d519-313">Na het aanroepen van [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourneert ' True ', de [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) methode moet aanroepen de [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) methode als een aanvullende controle voor wijzigingen die mogelijk schadelijke system.</span><span class="sxs-lookup"><span data-stu-id="0d519-313">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="0d519-314">Zie voor meer informatie over het aanroepen van deze methoden [Items wijzigen](#Renaming-Items).</span><span class="sxs-lookup"><span data-stu-id="0d519-314">For more information about calling these methods, see [Rename Items](#Renaming-Items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="0d519-315">Dynamische Parameters toevoegen aan de Cmdlet Copy-Item</span><span class="sxs-lookup"><span data-stu-id="0d519-315">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="0d519-316">Soms de `Copy-Item` cmdlet extra parameters die dynamisch zijn opgegeven tijdens runtime is vereist.</span><span class="sxs-lookup"><span data-stu-id="0d519-316">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="0d519-317">Voor deze dynamische parameters, de Windows PowerShell-container-provider moet implementeren de [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) methode voor het afhandelen van deze de parameters.</span><span class="sxs-lookup"><span data-stu-id="0d519-317">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="0d519-318">Deze methode haalt de parameters voor het item in het opgegeven pad en retourneert een object met eigenschappen en velden met het parseren van kenmerken die vergelijkbaar is met een cmdlet-klasse of een [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span><span class="sxs-lookup"><span data-stu-id="0d519-318">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="0d519-319">De Windows PowerShell-runtime maakt gebruik van het geretourneerde object om toe te voegen van de parameters voor de `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0d519-319">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="0d519-320">Deze provider wordt niet geïmplementeerd voor deze methode.</span><span class="sxs-lookup"><span data-stu-id="0d519-320">This provider does not implement this method.</span></span> <span data-ttu-id="0d519-321">De volgende code is echter de standaardimplementatie van [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="0d519-321">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="0d519-322">Voorbeeld van code</span><span class="sxs-lookup"><span data-stu-id="0d519-322">Code Sample</span></span>

<span data-ttu-id="0d519-323">Zie voor een compleet voorbeeld van code, [AccessDbProviderSample04 codevoorbeeld](./accessdbprovidersample04-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="0d519-323">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="0d519-324">Het bouwen van de Windows PowerShell-Provider</span><span class="sxs-lookup"><span data-stu-id="0d519-324">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="0d519-325">Zie [over het registreren van Providers,-Cmdlets en -toepassingen hosten](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="0d519-325">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="0d519-326">De Windows PowerShell-Provider testen</span><span class="sxs-lookup"><span data-stu-id="0d519-326">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="0d519-327">Als uw Windows PowerShell-provider is geregistreerd met Windows PowerShell, kunt u deze testen door het uitvoeren van de ondersteunde cmdlets op de opdrachtregel.</span><span class="sxs-lookup"><span data-stu-id="0d519-327">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="0d519-328">Let erop dat de volgende voorbeelduitvoer wordt gebruikt een fictieve Access-database.</span><span class="sxs-lookup"><span data-stu-id="0d519-328">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="0d519-329">Voer de `Get-ChildItem` cmdlet voor het ophalen van de lijst met onderliggende items uit een klantentabel in de Access-database.</span><span class="sxs-lookup"><span data-stu-id="0d519-329">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="0d519-330">De volgende uitvoer wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-330">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="0d519-331">Voer de `Get-ChildItem` cmdlet opnieuw uit voor het ophalen van de gegevens van een tabel.</span><span class="sxs-lookup"><span data-stu-id="0d519-331">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="0d519-332">De volgende uitvoer wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-332">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="0d519-333">Gebruik nu de `Get-Item` cmdlet voor het ophalen van de items in rij 0 in de tabel.</span><span class="sxs-lookup"><span data-stu-id="0d519-333">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="0d519-334">De volgende uitvoer wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-334">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="0d519-335">Hergebruik `Get-Item` om op te halen van de gegevens voor de items in de rij 0.</span><span class="sxs-lookup"><span data-stu-id="0d519-335">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="0d519-336">De volgende uitvoer wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-336">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="0d519-337">Gebruik nu de `New-Item` cmdlet om een rij toevoegt aan een bestaande tabel.</span><span class="sxs-lookup"><span data-stu-id="0d519-337">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="0d519-338">De `Path` parameter Hiermee geeft u het volledige pad naar de rij en dient een rijnummer aan te geven dat groter is dan het bestaande aantal rijen in de tabel.</span><span class="sxs-lookup"><span data-stu-id="0d519-338">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="0d519-339">De `Type` parameter geeft 'rij' als u wilt opgeven dat type item toe te voegen.</span><span class="sxs-lookup"><span data-stu-id="0d519-339">The `Type` parameter indicates "row" to specify that type of item to add.</span></span> <span data-ttu-id="0d519-340">Ten slotte de `Value` parameter geeft u een door komma's gescheiden lijst met waarden van de kolom voor de rij.</span><span class="sxs-lookup"><span data-stu-id="0d519-340">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAddress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="0d519-341">Controleer de juistheid van de bewerking van het nieuwe item als volgt.</span><span class="sxs-lookup"><span data-stu-id="0d519-341">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="0d519-342">De volgende uitvoer wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="0d519-342">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="0d519-343">Zie ook</span><span class="sxs-lookup"><span data-stu-id="0d519-343">See Also</span></span>

[<span data-ttu-id="0d519-344">Het maken van Windows PowerShell-Providers</span><span class="sxs-lookup"><span data-stu-id="0d519-344">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="0d519-345">Het ontwerpen van uw Windows PowerShell-Provider</span><span class="sxs-lookup"><span data-stu-id="0d519-345">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="0d519-346">Implementatie van een Item Windows PowerShell-Provider</span><span class="sxs-lookup"><span data-stu-id="0d519-346">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="0d519-347">Implementatie van een Windows PowerShell-Provider van navigatie</span><span class="sxs-lookup"><span data-stu-id="0d519-347">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

[<span data-ttu-id="0d519-348">Over het registreren van Providers,-Cmdlets en -toepassingen hosten</span><span class="sxs-lookup"><span data-stu-id="0d519-348">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="0d519-349">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="0d519-349">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="0d519-350">Windows PowerShell-programmeergids</span><span class="sxs-lookup"><span data-stu-id="0d519-350">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)